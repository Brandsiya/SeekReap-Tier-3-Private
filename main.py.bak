from fastapi import FastAPI
from pydantic import BaseModel

# Deterministic scoring class
class MonetizationScorer:
    def score(self, semantic_output: dict) -> dict:
        quality_score = semantic_output.get("quality_score", 0.8)
        risk_score = semantic_output.get("risk_score", 0.2)

        final_score = quality_score - risk_score  # replace with compute_score if available
        decision = "approve" if final_score >= 0.5 else "reject"  # replace with derive_decision if available

        return {
            "score": final_score,
            "decision": decision,
            "risk_score": risk_score,
            "quality_score": quality_score,
        }

app = FastAPI()
scorer = MonetizationScorer()

class Envelope(BaseModel):
    content: str
    quality_score: float = 0.8
    risk_score: float = 0.2

@app.post("/compute")
def compute(envelope: Envelope):
    semantic_output = {
        "quality_score": envelope.quality_score,
        "risk_score": envelope.risk_score,
    }
    return scorer.score(semantic_output)
